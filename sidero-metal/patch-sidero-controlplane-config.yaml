---
###
# This is a patch file use with `talosctl gen config ...`
#
# * Allow scheduling on master (for single-node control plane)
# * Disable the cloud-based discovery service and go back to k8s/etcd
###
version: v1alpha1
persist: true
machine:
  install:
    disk: /dev/sda
    image: ghcr.io/siderolabs/installer:v1.4.0
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.27.1
cluster:
  allowSchedulingOnMasters: true
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.27.1
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.27.1
  discovery:
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: true
  network:
    dnsDomain: "kubernetes.lesmerises.jgarfield.com"
  proxy:
    image: registry.k8s.io/kube-proxy:v1.27.1
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.27.1
